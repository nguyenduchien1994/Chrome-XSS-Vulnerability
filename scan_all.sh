DETECTOR="detect_xss.py"
CFG_FILES="/home/ubuntu/Chrome-XSS-Vulnerability/spoon-master/test/CFG_files"
OUTPUT_FILES="/home/ubuntu/Chrome-XSS-Vulnerability/outputs"

mkdir -p $OUTPUT_FILES

for ext in "$CFG_FILES"/* ; do
    if [[ -d $ext ]] ; then
        for f in "$ext"/* ; do
            if [[ -f $f ]] ; then
                mkdir -p "${OUTPUT_FILES}/${ext##*/}"
                outputfile="${OUTPUT_FILES}/${ext##*/}/${f##*/}.output"
                python $DETECTOR $f > $outputfile
                if [ ! -s $outputfile ] ; then
                    rm $outputfile # remove file if it's empty
                fi
            fi
            find $ext -type d -empty -delete # delete folder if no paths found
        done
    fi
done

