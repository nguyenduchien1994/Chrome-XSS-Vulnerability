import sys
sys.path.append('spoon-master/test/block')
sys.path.append('dijkstra')
from block_parser import get_sink_blocks, get_source_blocks
from path_finder import find_all_paths

if len(sys.argv) < 2:
    sys.exit("Usage: python detect_xss.py path/to/file.cfg")

cfg_file = sys.argv[1]

sources = map(lambda x: int(x.rstrip(' loop')), get_source_blocks(cfg_file))
sinks = map(lambda x: int(x.rstrip(' loop')), get_sink_blocks(cfg_file))

paths = find_all_paths(cfg_file, sources, sinks)
if len(paths) > 0:
    print "Path(s) found: %s" % paths

