import os
import sys
import re

sources = ["document.URL",
           "document.documentURI",
           "document.URLUnencoded",
           "document.baseURI",
           "document.cookie",
           "document.referrer",
           "location",
           "location.href",
           "location.search",
           "location.hash",
           "location.pathname",
           "localStorage.getItem",
           "sessionStorage.getItem",
           "sessionStorage.key",
           "responseText",
           "data",
           "value",
           "name",
           "window.name",
           "websockets.onMessage",
           ]

sinks = ["eval",
         "funcion",
         "setTimeout",
         "setInterval",
         "execScript",
         "crypto.generateCRFMRequest",
         "ScriptElement.src",
         "ScriptElement.text",
         "ScriptElement.textContent",
         "ScriptElement.innerText",
         ".onEventName",
         "document.write",
         "document.writeln",
         ".innerHTML",
         "Range.createContextualFragment",
         "HTMLButton.value",
         "location",
         "location.href",
         "location.pathname",
         "location.search",
         "location.protocol",
         "location.hostname",
         "location.assign",
         "location.replace",
         #"element.setAttribute"
         ]

path_to_CFG = "./spoon-master/test/CFG_files"

def get_immediate_subdirectories(a_dir):
    return [name for name in os.listdir(a_dir)
            if os.path.isdir(os.path.join(a_dir, name))]

def get_file(extension):
    path = path_to_CFG + "/" + extension
    js_files = {}
    for root, dirs, files in os.walk(path):
        for file in files:
            js_files[file] = os.path.join(root, file)
    return js_files

extensions = get_immediate_subdirectories(path_to_CFG)

for extension in extensions:
    files = get_file(extension)
    for file in files:
        f = open(files[file])

        thefile = f.read()

        f.close()


